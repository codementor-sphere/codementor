import{C as k,s as C,v as A,x as B,L as $,P as z,y as E,z as S,A as x,j as i,o as n,l as v,B as V,D as H,E as O,G as F,h as m,U as q,H as I,I as J,J as K,K as Q,M as T,k as e,F as f,m as _,n as y,c as W,N as X,q as w,t as c}from"./vendor-ynwioZzL.js";import{u as Y}from"./useApi-DtQPf3_y.js";import"./axios-BXw6veFj.js";import"./auth-D3OtdBq5.js";const Z={class:"h-64"},ee={__name:"UserGrowth",props:{labels:{type:Array,default:()=>[]},data:{type:Array,default:()=>[]}},setup(h){k.register(C,A,B,$,z,E,S);const l=h,r=x(()=>{const o=getComputedStyle(document.documentElement).getPropertyValue("--pri-500").trim()||"#0ea5e9";return{labels:l.labels,datasets:[{label:"Users",data:l.data,borderColor:o,tension:.4,fill:!1}]}}),u={responsive:!0,maintainAspectRatio:!1,scales:{y:{grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--gry-200").trim()||"#e5e7eb"}},x:{grid:{display:!1}}},plugins:{legend:{display:!1}}};return(o,g)=>(n(),i("div",Z,[v(V(H),{data:r.value,options:u},null,8,["data"])]))}},te={class:"h-64"},se={__name:"LessonEngagement",props:{labels:{type:Array,default:()=>[]},data:{type:Array,default:()=>[]}},setup(h){k.register(C,A,B,O,E,S);const l=h,r=x(()=>{const o=getComputedStyle(document.documentElement).getPropertyValue("--acc-ind-500").trim()||"#6366f1";return{labels:l.labels,datasets:[{label:"Views",backgroundColor:o,data:l.data}]}}),u={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--gry-200").trim()||"#e5e7eb"}},x:{grid:{display:!1}}}};return(o,g)=>(n(),i("div",te,[v(V(F),{data:r.value,options:u},null,8,["data"])]))}},ae={class:"space-y-6 px-2 md:px-0"},oe={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},le={class:"flex items-start gap-3"},ne={class:"flex-1"},re={class:"flex items-center gap-2"},ie={class:"text-xs text-gray-500 font-medium"},de={class:"mt-2 flex items-baseline gap-3"},ce={class:"text-2xl font-extrabold text-gray-900"},ue={class:"text-xs text-gray-400"},ge={class:"mt-3"},pe={key:0,class:"w-full h-6",viewBox:"0 0 100 20",preserveAspectRatio:"none"},me=["points"],he={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ve={class:"lg:col-span-2 bg-white p-6 rounded-2xl border border-gray-200 shadow-sm"},ye={class:"h-64"},xe={class:"space-y-6"},be={class:"bg-white p-4 rounded-2xl border border-gray-200 shadow-sm"},fe={class:"bg-white p-4 rounded-2xl border border-gray-200 shadow-sm"},_e={class:"space-y-3 max-h-48 overflow-auto pr-2"},we={class:"text-sm text-gray-800 font-medium"},ke={class:"text-xs text-gray-400"},Se={__name:"Dashboard",setup(h){const{get:l}=Y(),r=m([{label:"Active Users",value:"—",icon:q,iconBg:"bg-gradient-to-tr from-purple-600 to-teal-400"},{label:"Lessons Published",value:"—",icon:I,iconBg:"bg-indigo-600"},{label:"Challenges Solved",value:"—",icon:J,iconBg:"bg-green-600"},{label:"Avg. Completion Rate",value:"—",icon:K,iconBg:"bg-orange-500"}]),u=m([]),o=m({labels:[],data:[]}),g=m({labels:[],data:[]}),p=m(null),L=x(()=>{const t=o.value.data||[];if(!t.length)return"";const a=Math.max(...t),s=Math.min(...t),d=100,b=18;return t.map((U,G)=>{const N=G/(t.length-1)*d,R=b-(U-s)/(a-s||1)*b;return`${N},${R}`}).join(" ")});async function M(){try{const t=await l("/admin/stats");r.value[0].value=t.active_users_30d??0,r.value[1].value=t.lessons??0,r.value[2].value=t.challenges_solved??0,r.value[3].value=(t.avg_completion_rate??0)+"%"}catch(t){console.error("loadStats",t)}}async function P(){try{const t=await l("/admin/user-growth?months=6");o.value.labels=t.map(s=>s.period),o.value.data=t.map(s=>Number(s.count));const a=o.value.data;if(a.length>=2){const s=a[a.length-1],d=a[a.length-2]||s;p.value=d===0?null:Math.round((s-d)/d*100)}}catch(t){console.error("loadUserGrowth",t)}}async function j(){try{const t=await l("/admin/lesson-engagement?limit=8");g.value.labels=t.map(a=>a.title),g.value.data=t.map(a=>Number(a.views))}catch(t){console.error("loadLessonEngagement",t)}}async function D(){try{u.value=await l("/admin/recent-activity?limit=8")}catch(t){console.error("loadRecentActivity",t)}}return Q(async()=>{await Promise.all([M(),P(),j(),D()])}),(t,a)=>(n(),i("div",ae,[a[4]||(a[4]=T('<header class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"><div><h1 class="text-3xl font-extrabold text-gray-900">Dashboard</h1><p class="text-sm text-gray-500 mt-1">High-level overview of platform health and activity</p></div><div class="flex items-center gap-3"><div class="hidden sm:flex items-center gap-2 bg-white border border-gray-200 rounded-lg px-3 py-2 shadow-sm"><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z"></path></svg><span class="text-sm text-gray-600">Last 30 days</span></div><button class="inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-sm rounded-lg shadow-sm hover:shadow-md transition"><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3"></path></svg> Export </button></div></header>',1)),e("section",oe,[(n(!0),i(f,null,_(r.value,(s,d)=>(n(),i("div",{key:s.label,class:"bg-white border border-gray-200 rounded-2xl p-5 shadow-sm hover:shadow-md transition"},[e("div",le,[e("div",{class:y(["p-3 rounded-lg shrink-0",s.iconBg])},[(n(),W(X(s.icon),{class:"w-5 h-5 text-white"}))],2),e("div",ne,[e("div",re,[e("p",ie,c(s.label),1),d===0&&p.value!==null?(n(),i("span",{key:0,class:y([p.value>=0?"text-green-600":"text-red-600","text-xs font-semibold"])},c(p.value>=0?"+"+p.value+"%":p.value+"%"),3)):w("",!0)]),e("div",de,[e("h2",ce,c(s.value),1),e("p",ue,c(s.sub??""),1)]),e("div",ge,[d===0&&o.value.data.length?(n(),i("svg",pe,[e("polyline",{points:L.value,fill:"none",stroke:"url(#g)","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,me),a[0]||(a[0]=e("defs",null,[e("linearGradient",{id:"g",x1:"0",x2:"1"},[e("stop",{offset:"0%","stop-color":"#7c3aed"}),e("stop",{offset:"100%","stop-color":"#06b6d4"})])],-1))])):w("",!0)])])])]))),128))]),e("section",he,[e("div",ve,[a[1]||(a[1]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"User Growth"),e("div",{class:"text-sm text-gray-500"},"Monthly active users")],-1)),e("div",ye,[v(ee,{labels:o.value.labels,data:o.value.data},null,8,["labels","data"])])]),e("aside",xe,[e("div",be,[a[2]||(a[2]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Lesson Engagement",-1)),v(se,{labels:g.value.labels,data:g.value.data},null,8,["labels","data"])]),e("div",fe,[a[3]||(a[3]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Recent Activity",-1)),e("ul",_e,[(n(!0),i(f,null,_(u.value,s=>(n(),i("li",{key:s.id,class:"flex items-start justify-between"},[e("div",null,[e("p",we,c(s.title),1),e("p",ke,c(s.time),1)]),e("span",{class:y(["text-xs font-semibold px-2 py-1 rounded",s.type==="lesson"?"bg-indigo-100 text-indigo-700":s.type==="challenge"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"])},c(s.type),3)]))),128))])])])])]))}};export{Se as default};
