import{a as o}from"./axios-C5QMe_K2.js";import{h as s}from"./vendor-DOs60vln.js";const i={getOverview(){return o.get("/admin/analytics/overview")},getUserGrowth(r="30d"){return o.get(`/admin/analytics/user-growth?range=${r}`)},getSubmissionActivity(r="30d"){return o.get(`/admin/analytics/submission-activity?range=${r}`)},getLearningPaths(){return o.get("/admin/analytics/learning-paths")},getChallengeDifficulty(){return o.get("/admin/analytics/challenge-difficulty")},getLessonPerformance(){return o.get("/admin/analytics/lesson-performance")},getSessionStats(){return o.get("/admin/analytics/session-stats")},getTopPerformers(r=5){return o.get(`/admin/analytics/top-performers?limit=${r}`)},getRecentActivity(r=5){return o.get(`/admin/analytics/recent-activity?limit=${r}`)},getUserStats(){return o.get("/admin/analytics/user-stats")}};function H(){const r=s(!1),l=s(null),p=s({}),n=s([]),c=s({}),u=s({}),y=s([]),d=s({}),g=s([]),v=s({}),m=s([]),f=s([]);async function R(e="30d"){try{r.value=!0,l.value=null;const a=[P(),w(e),A(e),U(),S(),_(),b(),F(),G()];await Promise.all(a)}catch(a){l.value=a.message,console.error("Failed to load analytics:",a)}finally{r.value=!1}}async function w(e){try{const a=await i.getUserGrowth(e);n.value=Array.isArray(a.data)?a.data:[],n.value.length>0&&(c.value={dailyNewUsers:n.value[n.value.length-1]?.new_users||0,weeklyNewUsers:n.value.slice(-7).reduce((t,h)=>t+(h.new_users||0),0),monthlyGrowthRate:L(n.value),totalUsers:n.value.reduce((t,h)=>t+(h.new_users||0),0)})}catch(a){throw console.error("Failed to load user growth:",a),n.value=[],c.value={},a}}async function A(e){try{const t=(await i.getSubmissionActivity(e)).data||{};u.value={totalSubmissions:t.totalSubmissions||0,passedSubmissions:t.passedSubmissions||0,failedSubmissions:t.failedSubmissions||0,successRate:t.successRate||0,dailyStats:Array.isArray(t.dailyStats)?t.dailyStats:[],languageUsage:Array.isArray(t.languageUsage)?t.languageUsage:[]}}catch(a){throw console.error("Failed to load submission activity:",a),u.value={totalSubmissions:0,passedSubmissions:0,failedSubmissions:0,successRate:0,dailyStats:[],languageUsage:[]},a}}async function S(){try{const a=(await i.getChallengeDifficulty()).data||{};d.value={overall:a.overall||{avg_pass_rate:0,avg_attempts:0},challenges:Array.isArray(a.challenges)?a.challenges:[]}}catch(e){throw console.error("Failed to load challenge difficulty:",e),d.value={overall:{avg_pass_rate:0,avg_attempts:0},challenges:[]},e}}async function b(){try{const a=(await i.getSessionStats()).data||{};v.value={dailyActivity:Array.isArray(a.dailyActivity)?a.dailyActivity:[],peakHours:Array.isArray(a.peakHours)?a.peakHours:[]}}catch(e){throw console.error("Failed to load session stats:",e),v.value={dailyActivity:[],peakHours:[]},e}}function L(e){if(!Array.isArray(e)||e.length<2)return 0;const a=e.slice(-1)[0]?.new_users||0,t=e.slice(-2)[0]?.new_users||0;return t===0?a>0?100:0:Math.round((a-t)/t*100)}async function P(){try{const e=await i.getOverview();p.value=e.data}catch(e){throw console.error("Failed to load platform overview:",e),e}}async function U(){try{const e=await i.getLearningPaths();y.value=Array.isArray(e.data)?e.data:[]}catch(e){throw console.error("Failed to load learning paths:",e),y.value=[],e}}async function _(){try{const e=await i.getLessonPerformance();g.value=Array.isArray(e.data)?e.data:[]}catch(e){throw console.error("Failed to load lesson performance:",e),g.value=[],e}}async function F(){try{const e=await i.getTopPerformers(5);m.value=Array.isArray(e.data)?e.data:[]}catch(e){throw console.error("Failed to load top performers:",e),m.value=[],e}}async function G(){try{const e=await i.getRecentActivity(5);f.value=Array.isArray(e.data)?e.data:[]}catch(e){throw console.error("Failed to load recent activity:",e),f.value=[],e}}return{loading:r,error:l,platformOverview:p,userGrowthData:n,userGrowthStats:c,submissionActivity:u,learningPathEngagement:y,challengeDifficulty:d,lessonPerformance:g,sessionAnalytics:v,topPerformers:m,recentActivity:f,loadAllAnalytics:R,loadPlatformOverview:P,loadUserGrowth:w,loadSubmissionActivity:A,loadLearningPaths:U,loadChallengeDifficulty:S,loadLessonPerformance:_,loadSessionStats:b,loadTopPerformers:F,loadRecentActivity:G}}export{H as u};
